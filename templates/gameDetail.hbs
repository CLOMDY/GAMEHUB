<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{game.title}}</title>
    <link rel="icon" href="/img/logo.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bungee+Spice&display=swap" rel="stylesheet">
    <style>
        .gameList1 {
            text-align: center;
            font-size: clamp(24px, 5vw, 40px);

            font-family: Bungee Spice;
            background-color: #ffcd39;
            border-radius: 20px;
            border: 2px solid #ce1a00;
            letter-spacing: 0.4em;
            box-shadow: 0px 0px 100px #ce1a00;
            padding: 10px;
        }

        .detail {
            font-family: Bungee Spice;
            background-color: #ffcd39;
            border-radius: 20px;
            border: 2px solid #ce1a00;
            box-shadow: 0px 0px 100px #ce1a00;
            margin: 10px 0;
            padding: 10px;
        }

        .vid {
            width: calc(100% + 20px);
            /* 10px left + 10px right padding */
            margin-left: -10px;
            margin-right: -10px;
            margin-top: -10px;
            border-radius: 20px 20px 0 0;
            box-shadow: 0px 10px 50px black;
        }



        .ss {
            width: 100%;
            aspect-ratio: 16/9;
            border-radius: 10px;
            border: #ce1a00 2px solid;
            transition: 0.5s ease;
        }

        .ss:hover {
            scale: 1.05;
        }

        .info {
            border: #ce1a00 5px solid;
            margin: 20px auto;
            padding: 20px;
            border-radius: 10px;
            background-color: #ffde7d;
            max-width: 100%;
        }

        .info .row {
            font-size: 5vw;
        }

        @media (min-width: 768px) {
            .info .row {
                font-size: 30px;
            }
        }

        .buy-btn {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            border-radius: 10px;
            font-family: Bungee Spice;
            border: 2px red solid;
            font-size: 10vw;
            background-color: #ffde7d;
        }

        @media (min-width: 768px) {
            .buy-btn {
                font-size: 80px;
            }
        }

        @keyframes popup-scale-in {
            0% {
                transform: scale(0.7) translate(-50%, -50%);
                opacity: 0;
            }

            100% {
                transform: scale(1) translate(-50%, -50%);
                opacity: 1;
            }
        }

        #buy-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            backdrop-filter: blur(8px);
            background-color: rgba(0, 0, 0, 0.3);
            z-index: 9998;
        }

        #buy-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #ffcd39;
            border: 2px solid #ce1a00;
            border-radius: 20px;
            padding: 30px 60px;
            font-family: 'Bungee Spice', cursive;
            font-size: 32px;
            z-index: 9999;
            box-shadow: 0 0 20px #ce1a00;
            animation: popup-scale-in 0.5s ease-out forwards;
            opacity: 0;
        }

        .sparkle {
            position: fixed;
            width: 14px;
            height: 14px;
            background-color: #fff200;
            border-radius: 50%;
            pointer-events: none;
            z-index: 9997;
            animation: sparkle-float 1.5s ease-out forwards;
            opacity: 1;
            filter: drop-shadow(0 0 10px #ffc107) brightness(1.8);
        }

        @keyframes sparkle-float {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }

            100% {
                transform: translateY(-100px) scale(0.7);
                opacity: 0;
            }
        }
    </style>
</head>

<body style="background: url({{game.wallpaper}}); background-repeat: no-repeat; background-size: cover;">
    {{>header}}

    <div class="container">
        <div class="gameList1">
            {{game.title}}
        </div>

        <div class="detail">
            <video loop autoplay controls class="vid" controlsList="nodownload">
                <source src="{{game.video}}" type="video/mp4">
            </video>
            <div class="text-center fs-1" style="margin-top: 30px;">
                DETAILS
            </div>
            <div class="px-3 text-justify">
                {{game.about}}
            </div>

            <div class="info">
                <div class="row">
                    <div class="col-6 text-end">COMPANY:</div>
                    <div class="col-6 text-start">{{game.company}}</div>
                </div>
                <div class="row">
                    <div class="col-6 text-end">GENRE:</div>
                    <div class="col-6 text-start">{{game.genre}}</div>
                </div>
                <div class="row">
                    <div class="col-6 text-end">RATING:</div>
                    <div class="col-6 text-start">{{game.rating}}</div>
                </div>
                <div class="row">
                    <div class="col-6 text-end">TOURNAMENT:</div>
                    <div class="col-6 text-start">{{game.tournament}}</div>
                </div>
                <div class="row">
                    <div class="col-6 text-end">SELLS:</div>
                    <div class="col-6 text-start">{{game.bought}}</div>
                </div>
            </div>

            <div class="text-center fs-1">
                SCREENSHOTS
                <div class="fs-6">
                    CLICK TO EXPAND
                </div>
            </div>

            <div class="row g-3 mt-2">
                <div class="col-12 col-md-6">
                    <img src="{{game.SS1}}" class="ss" onclick="location.href='{{game.SS1}}'">
                </div>
                <div class="col-12 col-md-6">
                    <img src="{{game.SS2}}" class="ss" onclick="location.href='{{game.SS2}}'">
                </div>
            </div>

            <div class="row g-3 mt-2">
                <div class="col-12 col-md-6">
                    <img src="{{game.SS3}}" class="ss" onclick="location.href='{{game.SS3}}'">
                </div>
                <div class="col-12 col-md-6">
                    <img src="{{game.SS4}}" class="ss" onclick="location.href='{{game.SS4}}'">
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12 text-center">
                    <input type="submit" value="BUY ${{game.price}}"
                        onclick="location.href='/buyGame?gameCode={{game.gameCode}}'" class="buy-btn">
                </div>

            </div>

        </div>

    </div>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get("bought") === "true") {
            const overlay = document.createElement("div");
            overlay.id = "buy-overlay";

            const popup = document.createElement("div");
            popup.id = "buy-popup";
            popup.textContent = "Purchase Successful!";

            document.body.appendChild(overlay);
            document.body.appendChild(popup);

            // Generate sparkles randomly behind popup
            const sparkleInterval = setInterval(() => {
                const sparkle = document.createElement("div");
                sparkle.className = "sparkle";
                sparkle.style.left = Math.random() * 100 + "vw";
                sparkle.style.top = 60 + Math.random() * 20 + "vh"; // around popup area
                document.body.appendChild(sparkle);

                setTimeout(() => sparkle.remove(), 1000);
            }, 100);

            // Remove everything after 3s
            setTimeout(() => {
                popup.remove();
                overlay.remove();
                clearInterval(sparkleInterval);
                document.querySelectorAll(".sparkle").forEach(el => el.remove());
                history.replaceState(null, '', location.pathname + location.search.replace("&bought=true", "").replace("?bought=true", ""));
            }, 3000);
        }

        
    </script>




</body>

</html>